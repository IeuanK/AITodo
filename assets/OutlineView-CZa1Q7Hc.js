import{_ as V,u as P,r as D,c as k,a as J,b as a,o as s,d as e,e as T,w as Q,f as h,n as x,g as A,t as b,v as W,h as U,F as L,i as B,j,k as X}from"./index-C8FvJDHe.js";const Z={key:1,class:"arrow-placeholder"},ee=["checked"],te={key:0,class:"task-title-wrapper"},se={class:"task-title"},le={class:"task-badges"},ae={key:0,class:"badge star"},ne={key:2,class:"badge context"},oe={key:3,class:"badge child-count"},ie={class:"task-actions"},de={key:0,class:"task-children"},ce={class:"color-grid"},re=["onClick"],ue={__name:"TaskTreeItem",props:{task:{type:Object,required:!0},indentLevel:{type:Number,default:0},selectedTaskId:{type:String,default:null}},emits:["select","toggle-complete","update","delete","add-child"],setup(o,{emit:i}){const l=o,v=i,I=P(),f=D(!0),g=D(!1),p=D(""),y=D(null),w=D(!1),S=["#e0e0e0","#ffcdd2","#f8bbd0","#e1bee7","#c5cae9","#bbdefb","#b2dfdb","#c8e6c9","#fff9c4","#ffe0b2","#d7ccc8","#b0bec5"],m=k(()=>l.task.childIds&&l.task.childIds.length>0),E=k(()=>m.value?I.getChildTasks(l.task.id):[]),_=k(()=>l.task.childIds?l.task.childIds.length:0),N=k(()=>l.task.id===l.selectedTaskId),d=k(()=>{if(!l.task.dueDate)return"";const r=new Date,t=new Date(l.task.dueDate),C=Math.ceil((t-r)/(1e3*60*60*24));return C<0?"overdue":C===0?"today":C<=3?"soon":""}),c=()=>{m.value&&(f.value=!f.value)},$=()=>{v("select",l.task.id)},z=()=>{v("toggle-complete",l.task.id)},F=()=>{l.task.isCompleted||(g.value=!0,p.value=l.task.title,X(()=>{y.value&&(y.value.focus(),y.value.select())}))},M=()=>{p.value.trim()&&p.value!==l.task.title&&v("update",{id:l.task.id,updates:{title:p.value.trim()}}),g.value=!1},K=()=>{g.value=!1,p.value=""},q=()=>{confirm("Delete this task and all its children?")&&v("delete",{id:l.task.id,deleteChildren:!0})},R=()=>{v("add-child",l.task.id)},Y=r=>{if(!r)return"";const t=new Date(r),n=Math.ceil((t-new Date)/(1e3*60*60*24));return n===0?"Today":n===1?"Tomorrow":n===-1?"Yesterday":n<0?`${Math.abs(n)}d overdue`:n<=7?`${n}d`:t.toLocaleDateString("en-US",{month:"short",day:"numeric"})},G=()=>{w.value=!0},O=()=>{w.value=!1},H=r=>{v("update",{id:l.task.id,updates:{color:r}}),O()};return(r,t)=>{const C=J("TaskTreeItem",!0);return s(),a("div",{class:"task-tree-item",style:A({"--indent-level":o.indentLevel})},[e("div",{class:x(["task-row",{completed:o.task.isCompleted,selected:N.value,"has-children":m.value}]),onClick:$,onDblclick:F},[t[8]||(t[8]=e("div",{class:"indent-spacer"},null,-1)),e("div",{class:"expand-toggle",onClick:h(c,["stop"])},[m.value?(s(),a("span",{key:0,class:x(["arrow",{expanded:f.value}])},"â–¶",2)):(s(),a("span",Z))]),e("div",{class:"color-indicator",style:A({backgroundColor:o.task.color||"#e0e0e0"}),onClick:h(G,["stop"])},null,4),e("input",{type:"checkbox",checked:o.task.isCompleted,onChange:h(z,["stop"]),class:"task-checkbox"},null,40,ee),g.value?Q((s(),a("input",{key:1,ref_key:"titleInput",ref:y,"onUpdate:modelValue":t[0]||(t[0]=n=>p.value=n),onBlur:M,onKeydown:[U(M,["enter"]),U(K,["esc"])],class:"task-title-input",onClick:t[1]||(t[1]=h(()=>{},["stop"]))},null,544)),[[W,p.value]]):(s(),a("div",te,[e("span",se,b(o.task.title),1),e("div",le,[o.task.isStarred?(s(),a("span",ae,"â­")):T("",!0),o.task.dueDate?(s(),a("span",{key:1,class:x(["badge due-date",d.value])},b(Y(o.task.dueDate)),3)):T("",!0),o.task.contexts&&o.task.contexts.length>0?(s(),a("span",ne," @"+b(o.task.contexts[0]),1)):T("",!0),m.value?(s(),a("span",oe,b(_.value),1)):T("",!0)])])),e("div",ie,[e("button",{onClick:h(R,["stop"]),class:"action-btn",title:"Add child task"},"+"),e("button",{onClick:h(q,["stop"]),class:"action-btn danger",title:"Delete task"},"Ã—")])],34),f.value&&m.value?(s(),a("div",de,[(s(!0),a(L,null,B(E.value,n=>(s(),j(C,{key:n.id,task:n,"indent-level":o.indentLevel+1,"selected-task-id":o.selectedTaskId,onSelect:t[2]||(t[2]=u=>r.$emit("select",u)),onToggleComplete:t[3]||(t[3]=u=>r.$emit("toggle-complete",u)),onUpdate:t[4]||(t[4]=u=>r.$emit("update",u)),onDelete:t[5]||(t[5]=u=>r.$emit("delete",u)),onAddChild:t[6]||(t[6]=u=>r.$emit("add-child",u))},null,8,["task","indent-level","selected-task-id"]))),128))])):T("",!0),w.value?(s(),a("div",{key:1,class:"color-picker-overlay",onClick:h(O,["stop"])},[e("div",{class:"color-picker",onClick:t[7]||(t[7]=h(()=>{},["stop"]))},[t[9]||(t[9]=e("div",{class:"color-picker-title"},"Choose Color",-1)),e("div",ce,[(s(),a(L,null,B(S,n=>e("div",{key:n,class:x(["color-option",{selected:o.task.color===n}]),style:A({backgroundColor:n}),onClick:u=>H(n)},null,14,re)),64))])])])):T("",!0)],4)}}},ke=V(ue,[["__scopeId","data-v-6f73b5d4"]]),ve={class:"view-container"},pe={class:"view-header"},me={class:"view-title-section"},he={class:"task-count"},fe={class:"view-content"},ge={key:0,class:"loading-message"},ye={key:1,class:"error-message"},Ce={key:2,class:"empty-state"},Te={key:3,class:"task-tree"},be={__name:"OutlineView",setup(o){const i=P(),l=k(()=>i.loading),v=k(()=>i.error),I=k(()=>i.tasks),f=k(()=>i.rootTasks),g=k(()=>i.selectedTaskId),p=async()=>{const d=await i.createTask({title:"New Task",isInInbox:!1,color:null});i.selectTask(d.id)},y=d=>{i.selectTask(d)},w=async d=>{await i.toggleComplete(d)},S=async({id:d,updates:c})=>{await i.updateTask(d,c)},m=async({id:d,deleteChildren:c})=>{await i.deleteTask(d,c)},E=async d=>{const c=await i.createTask({title:"New Child Task",parentId:d,isInInbox:!1,color:null});i.selectTask(c.id)},_=()=>{console.log("Expand all - to be implemented")},N=()=>{console.log("Collapse all - to be implemented")};return(d,c)=>(s(),a("div",ve,[e("div",pe,[e("div",me,[c[0]||(c[0]=e("h2",{class:"view-title"},"ðŸ“‹ Outline",-1)),e("span",he,b(I.value.length)+" tasks",1)]),e("div",{class:"view-actions"},[e("button",{onClick:_,class:"btn-secondary",title:"Expand all"}," âŠž "),e("button",{onClick:N,class:"btn-secondary",title:"Collapse all"}," âŠŸ "),e("button",{onClick:p,class:"btn-primary"},"+ New Task")])]),e("div",fe,[l.value?(s(),a("div",ge,"Loading tasks...")):v.value?(s(),a("div",ye,b(v.value),1)):I.value.length===0?(s(),a("div",Ce,[...c[1]||(c[1]=[e("div",{class:"empty-icon"},"ðŸ“‹",-1),e("h3",null,"No tasks yet",-1),e("p",null,'Click "New Task" to create your first task',-1)])])):(s(),a("div",Te,[(s(!0),a(L,null,B(f.value,$=>(s(),j(ke,{key:$.id,task:$,"indent-level":0,"selected-task-id":g.value,onSelect:y,onToggleComplete:w,onUpdate:S,onDelete:m,onAddChild:E},null,8,["task","selected-task-id"]))),128))]))])]))}},De=V(be,[["__scopeId","data-v-98bf4760"]]);export{De as default};
